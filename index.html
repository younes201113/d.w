<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ØªØ­Ù…ÙŠÙ„ Ø£Ù„Ø¹Ø§Ø¨ ÙˆØªØ·Ø¨ÙŠÙ‚Ø§Øª</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <h1>Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ­Ù…ÙŠÙ„Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹</h1>
    <input type="text" id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù„Ø¹Ø¨Ø© Ø£Ùˆ ØªØ·Ø¨ÙŠÙ‚..." />
  </header>

  <main id="apps-container"></main>

  <script>
    fetch('apps.json')
      .then(res => res.json())
      .then(apps => {
        const container = document.getElementById('apps-container');
        const search = document.getElementById('search');

        function renderApps(filteredApps) {
          container.innerHTML = '';
          filteredApps.forEach(app => {
            const card = document.createElement('div');
            card.className = 'app-card';
            card.innerHTML = `
              <img src="${app.image}" alt="${app.title}" />
              <h3>${app.title}</h3>
              <p>${app.description}</p>
              <p><strong>Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</strong> ${app.version} | ${app.size}</p>
              <a href="${app.file}" class="download-btn" download>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢Ù†</a>
            `;
            container.appendChild(card);
          });
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„ Ø£ÙˆÙ„ Ù…Ø±Ø©
        renderApps(apps);

        // Ø§Ù„Ø¨Ø­Ø«
        search.addEventListener('input', e => {
          const term = e.target.value.toLowerCase();
          const filtered = apps.filter(app => 
            app.title.toLowerCase().includes(term) || 
            app.description.toLowerCase().includes(term)
          );
          renderApps(filtered);
        });
      })
      .catch(err => console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', err));
  </script>
  <script>
document.addEventListener('DOMContentLoaded', () => {
  const appsContainer = document.getElementById('apps-grid');
  const searchInput = document.getElementById('search');
  const categorySelect = document.getElementById('category');

  let allApps = [];

  // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  fetch('apps.json')
    .then(res => {
      if (!res.ok) throw new Error('Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØªØ­Ù…ÙŠÙ„ apps.json');
      return res.json();
    })
    .then(apps => {
      allApps = apps;
      renderApps(apps);

      if (searchInput) searchInput.addEventListener('input', filterApps);
      if (categorySelect) categorySelect.addEventListener('change', filterApps);
    })
    .catch(err => {
      console.error('Ø®Ø·Ø£:', err);
      if (appsContainer) {
        appsContainer.innerHTML = '<p style="color:red; text-align:center;">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>';
      }
    });

  function renderApps(appsList) {
    if (!appsContainer) return;
    appsContainer.innerHTML = '';

    if (appsList.length === 0) {
      appsContainer.innerHTML = '<p style="text-align:center; color:#777;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</p>';
      return;
    }

    appsList.forEach(app => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img class="icon" src="${app.icon || 'https://via.placeholder.com/80?text=' + app.title}" alt="${app.title}">
        <h3>${app.title}</h3>
        <div class="meta">
          <span>${app.category === 'games' ? 'ğŸ® Ø£Ù„Ø¹Ø§Ø¨' : 'ğŸ› ï¸ ØªØ·Ø¨ÙŠÙ‚Ø§Øª'}</span>
          <span>Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${app.version || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
          <span>${app.size || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
        </div>
        <a href="detail.html?id=${app.id}" class="download-btn">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>
      `;
      appsContainer.appendChild(card);
    });
  }

  function filterApps() {
    const term = searchInput?.value.toLowerCase().trim() || '';
    const cat = categorySelect?.value || 'all';

    let filtered = allApps;

    if (term) {
      filtered = filtered.filter(app =>
        (app.title || '').toLowerCase().includes(term) ||
        (app.description || '').toLowerCase().includes(term)
      );
    }

    if (cat !== 'all') {
      filtered = filtered.filter(app => app.category === cat);
    }

    renderApps(filtered);
  }

  // Dark Mode (Ø¨Ø³ÙŠØ· Ø¬Ø¯Ø§Ù‹)
  const themeToggle = document.getElementById('theme-toggle');
  if (themeToggle) {
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø£Ùˆ Ø­Ø³Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù…
    const saved = localStorage.getItem('theme');
    if (saved) {
      if (saved === 'dark') document.documentElement.classList.add('dark');
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.classList.add('dark');
    }
  }
});
</script>
</body>
</html>
